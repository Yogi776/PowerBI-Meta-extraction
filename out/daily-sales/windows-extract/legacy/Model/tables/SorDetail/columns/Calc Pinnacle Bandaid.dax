if(if(AND([MProductClass]="SPIN",SorDetail[MStockCode]<>""),lookupvalue(InvMaster[ProductClass],InvMaster[StockCode],SorDetail[MStockCode]),SorDetail[Calc Product Class])="",SorDetail[Calc Product Class],if(AND([MProductClass]="SPIN",SorDetail[MStockCode]<>""),lookupvalue(InvMaster[ProductClass],InvMaster[StockCode],SorDetail[MStockCode]),SorDetail[Calc Product Class]))